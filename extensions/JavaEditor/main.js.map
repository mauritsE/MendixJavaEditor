{
  "version": 3,
  "sources": ["../../src/main/index.ts"],
  "sourcesContent": ["import { IComponent, getStudioProApi, ComponentContext, MessageInfo } from \"@mendix/extensions-api\";\n\ninterface JavaEditorMessage {\n    type: \"openJavaFile\" | \"saveJavaFile\" | \"getJavaFile\";\n    filePath?: string;\n    content?: string;\n    javaActionName?: string;\n    moduleName?: string;\n}\n\ninterface JavaEditorResponse {\n    type: \"javaFileContent\" | \"saveResult\" | \"error\";\n    content?: string;\n    filePath?: string;\n    success?: boolean;\n    error?: string;\n}\n\nlet studioPro: ReturnType<typeof getStudioProApi>;\n\nexport const component: IComponent = {\n    async loaded(componentContext: ComponentContext) {\n        studioPro = getStudioProApi(componentContext);\n\n        // Add context menu item to Java Actions in the App Explorer\n        await studioPro.ui.appExplorer.addContextMenu(\n            {\n                menuId: \"JavaEditor.OpenEditor\",\n                caption: \"Edit Java Source\",\n                action: async () => {\n                    // Get the active document info to determine which Java Action was right-clicked\n                    const activeDoc = await studioPro.ui.editors.getActiveDocument();\n                    if (activeDoc && activeDoc.documentName && activeDoc.moduleName) {\n                        await openJavaEditorTab(activeDoc.documentName, activeDoc.moduleName);\n                    }\n                }\n            },\n            \"JavaActions$JavaAction\"\n        );\n\n        // Also add menu item to the Extensions menu for convenience\n        await studioPro.ui.extensionsMenu.add({\n            menuId: \"JavaEditor.MainMenu\",\n            caption: \"Java Editor\",\n            subMenus: [\n                { menuId: \"JavaEditor.OpenCurrentAction\", caption: \"Edit Current Java Action\" },\n            ],\n        });\n\n        // Handle extensions menu clicks\n        studioPro.ui.extensionsMenu.addEventListener(\n            \"menuItemActivated\",\n            async (args) => {\n                if (args.menuId === \"JavaEditor.OpenCurrentAction\") {\n                    const activeDoc = await studioPro.ui.editors.getActiveDocument();\n                    if (activeDoc && activeDoc.documentType === \"JavaActions$JavaAction\" && activeDoc.documentName && activeDoc.moduleName) {\n                        await openJavaEditorTab(activeDoc.documentName, activeDoc.moduleName);\n                    } else {\n                        await studioPro.ui.messageBoxes.show(\n                            \"warning\",\n                            \"No Java Action Selected\",\n                            \"Please open a Java Action document first.\"\n                        );\n                    }\n                }\n            }\n        );\n\n        // Set up message handler to communicate with UI\n        await studioPro.ui.messagePassing.addMessageHandler<JavaEditorMessage>(async (messageInfo: MessageInfo<JavaEditorMessage>) => {\n            const message = messageInfo.message;\n            try {\n                if (message.type === \"getJavaFile\" && message.filePath) {\n                    const content = await studioPro.app.files.getFile(message.filePath);\n                    await studioPro.ui.messagePassing.sendResponse<JavaEditorResponse>(messageInfo.messageId, {\n                        type: \"javaFileContent\",\n                        content: content,\n                        filePath: message.filePath\n                    });\n                } else if (message.type === \"saveJavaFile\" && message.filePath && message.content !== undefined) {\n                    await studioPro.app.files.putFile(message.filePath, message.content);\n                    await studioPro.ui.messagePassing.sendResponse<JavaEditorResponse>(messageInfo.messageId, {\n                        type: \"saveResult\",\n                        success: true,\n                        filePath: message.filePath\n                    });\n                }\n            } catch (error) {\n                await studioPro.ui.messagePassing.sendResponse<JavaEditorResponse>(messageInfo.messageId, {\n                    type: \"error\",\n                    error: error instanceof Error ? error.message : \"Unknown error occurred\"\n                });\n            }\n        });\n    }\n};\n\nasync function openJavaEditorTab(javaActionName: string, moduleName: string): Promise<void> {\n    // Java action source files are located at javasource/<ModuleName>/actions/<ActionName>.java\n    const javaFilePath = `javasource/${moduleName}/actions/${javaActionName}.java`;\n    \n    await studioPro.ui.tabs.open(\n        {\n            title: `${javaActionName}.java`,\n            icon: \"\u2615\"\n        },\n        {\n            componentName: \"extension/JavaEditor\",\n            uiEntrypoint: \"tab\",\n            queryParams: {\n                filePath: javaFilePath,\n                actionName: javaActionName,\n                moduleName: moduleName\n            }\n        }\n    );\n}\n\n"],
  "mappings": ";;;;;;AAkBA,IAAI;AAEG,IAAM,YAAwB;AAAA,EACjC,MAAM,OAAO,kBAAoC;AAC7C,gBAAY,EAAgB,gBAAgB;AAG5C,UAAM,UAAU,GAAG,YAAY;AAAA,MAC3B;AAAA,QACI,QAAQ;AAAA,QACR,SAAS;AAAA,QACT,QAAQ,YAAY;AAEhB,gBAAM,YAAY,MAAM,UAAU,GAAG,QAAQ,kBAAkB;AAC/D,cAAI,aAAa,UAAU,gBAAgB,UAAU,YAAY;AAC7D,kBAAM,kBAAkB,UAAU,cAAc,UAAU,UAAU;AAAA,UACxE;AAAA,QACJ;AAAA,MACJ;AAAA,MACA;AAAA,IACJ;AAGA,UAAM,UAAU,GAAG,eAAe,IAAI;AAAA,MAClC,QAAQ;AAAA,MACR,SAAS;AAAA,MACT,UAAU;AAAA,QACN,EAAE,QAAQ,gCAAgC,SAAS,2BAA2B;AAAA,MAClF;AAAA,IACJ,CAAC;AAGD,cAAU,GAAG,eAAe;AAAA,MACxB;AAAA,MACA,OAAO,SAAS;AACZ,YAAI,KAAK,WAAW,gCAAgC;AAChD,gBAAM,YAAY,MAAM,UAAU,GAAG,QAAQ,kBAAkB;AAC/D,cAAI,aAAa,UAAU,iBAAiB,4BAA4B,UAAU,gBAAgB,UAAU,YAAY;AACpH,kBAAM,kBAAkB,UAAU,cAAc,UAAU,UAAU;AAAA,UACxE,OAAO;AACH,kBAAM,UAAU,GAAG,aAAa;AAAA,cAC5B;AAAA,cACA;AAAA,cACA;AAAA,YACJ;AAAA,UACJ;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAGA,UAAM,UAAU,GAAG,eAAe,kBAAqC,OAAO,gBAAgD;AAC1H,YAAM,UAAU,YAAY;AAC5B,UAAI;AACA,YAAI,QAAQ,SAAS,iBAAiB,QAAQ,UAAU;AACpD,gBAAM,UAAU,MAAM,UAAU,IAAI,MAAM,QAAQ,QAAQ,QAAQ;AAClE,gBAAM,UAAU,GAAG,eAAe,aAAiC,YAAY,WAAW;AAAA,YACtF,MAAM;AAAA,YACN;AAAA,YACA,UAAU,QAAQ;AAAA,UACtB,CAAC;AAAA,QACL,WAAW,QAAQ,SAAS,kBAAkB,QAAQ,YAAY,QAAQ,YAAY,QAAW;AAC7F,gBAAM,UAAU,IAAI,MAAM,QAAQ,QAAQ,UAAU,QAAQ,OAAO;AACnE,gBAAM,UAAU,GAAG,eAAe,aAAiC,YAAY,WAAW;AAAA,YACtF,MAAM;AAAA,YACN,SAAS;AAAA,YACT,UAAU,QAAQ;AAAA,UACtB,CAAC;AAAA,QACL;AAAA,MACJ,SAAS,OAAO;AACZ,cAAM,UAAU,GAAG,eAAe,aAAiC,YAAY,WAAW;AAAA,UACtF,MAAM;AAAA,UACN,OAAO,iBAAiB,QAAQ,MAAM,UAAU;AAAA,QACpD,CAAC;AAAA,MACL;AAAA,IACJ,CAAC;AAAA,EACL;AACJ;AAEA,eAAe,kBAAkB,gBAAwB,YAAmC;AAExF,QAAM,eAAe,cAAc,UAAU,YAAY,cAAc;AAEvE,QAAM,UAAU,GAAG,KAAK;AAAA,IACpB;AAAA,MACI,OAAO,GAAG,cAAc;AAAA,MACxB,MAAM;AAAA,IACV;AAAA,IACA;AAAA,MACI,eAAe;AAAA,MACf,cAAc;AAAA,MACd,aAAa;AAAA,QACT,UAAU;AAAA,QACV,YAAY;AAAA,QACZ;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ;AACJ;",
  "names": []
}
