{
  "version": 3,
  "sources": ["../../src/main/index.ts"],
  "sourcesContent": ["import { IComponent, getStudioProApi, ComponentContext } from \"@mendix/extensions-api\";\n\ninterface ContextMenuActionArg {\n    documentId: string;\n}\n\ninterface DocumentInfo {\n    documentId: string;\n    documentName: string;\n    moduleName: string;\n}\n\nlet studioPro: ReturnType<typeof getStudioProApi>;\n\n/**\n * Find document info (name and module) by document ID.\n * Searches through all modules and their folders to find the document.\n */\nasync function findDocumentById(documentId: string): Promise<DocumentInfo | null> {\n    const modules = await studioPro.app.model.projects.getModules();\n    \n    for (const module of modules) {\n        // Search in module root\n        const rootDocs = await studioPro.app.model.projects.getDocumentsInfo(module.$ID);\n        const rootMatch = rootDocs.find(doc => doc.$ID === documentId);\n        if (rootMatch && rootMatch.name) {\n            return {\n                documentId: documentId,\n                documentName: rootMatch.name,\n                moduleName: module.name\n            };\n        }\n        \n        // Search in folders (recursive)\n        const found = await searchFoldersForDocument(module.$ID, module.name, documentId);\n        if (found) {\n            return found;\n        }\n    }\n    \n    return null;\n}\n\n/**\n * Recursively search folders for a document by ID\n */\nasync function searchFoldersForDocument(containerId: string, moduleName: string, documentId: string): Promise<DocumentInfo | null> {\n    const folders = await studioPro.app.model.projects.getFolders(containerId);\n    \n    for (const folder of folders) {\n        // Check documents in this folder\n        const docs = await studioPro.app.model.projects.getDocumentsInfo(folder.$ID);\n        const match = docs.find(doc => doc.$ID === documentId);\n        if (match && match.name) {\n            return {\n                documentId: documentId,\n                documentName: match.name,\n                moduleName: moduleName\n            };\n        }\n        \n        // Search subfolders\n        const found = await searchFoldersForDocument(folder.$ID, moduleName, documentId);\n        if (found) {\n            return found;\n        }\n    }\n    \n    return null;\n}\n\nexport const component: IComponent = {\n    async loaded(componentContext: ComponentContext) {\n        studioPro = getStudioProApi(componentContext);\n\n        // Add context menu item to Java Actions in the App Explorer\n        await studioPro.ui.appExplorer.addContextMenu(\n            {\n                menuId: \"JavaEditor.OpenEditor\",\n                caption: \"Edit Java Source\",\n                action: async (arg: ContextMenuActionArg) => {\n                    if (!arg || !arg.documentId) {\n                        await studioPro.ui.messageBoxes.show(\n                            \"warning\",\n                            \"Could not determine Java Action\",\n                            \"No document ID was provided by the context menu.\"\n                        );\n                        return;\n                    }\n                    \n                    // Look up document info by ID\n                    const docInfo = await findDocumentById(arg.documentId);\n                    \n                    if (docInfo) {\n                        await openJavaEditorTab(docInfo.documentName, docInfo.moduleName);\n                    } else {\n                        await studioPro.ui.messageBoxes.show(\n                            \"warning\",\n                            \"Could not find Java Action\",\n                            `Unable to find document with ID: ${arg.documentId}`\n                        );\n                    }\n                }\n            } as any,\n            \"JavaActions$JavaAction\"\n        );\n\n        // Also add menu item to the Extensions menu for convenience\n        await studioPro.ui.extensionsMenu.add({\n            menuId: \"JavaEditor.MainMenu\",\n            caption: \"Java Editor\",\n            subMenus: [\n                { menuId: \"JavaEditor.OpenCurrentAction\", caption: \"Edit Current Java Action\" },\n            ],\n        });\n\n        // Handle extensions menu clicks\n        studioPro.ui.extensionsMenu.addEventListener(\n            \"menuItemActivated\",\n            async (args) => {\n                if (args.menuId === \"JavaEditor.OpenCurrentAction\") {\n                    const activeDoc = await studioPro.ui.editors.getActiveDocument();\n                    if (activeDoc && activeDoc.documentType === \"JavaActions$JavaAction\" && activeDoc.documentName && activeDoc.moduleName) {\n                        await openJavaEditorTab(activeDoc.documentName, activeDoc.moduleName);\n                    } else {\n                        await studioPro.ui.messageBoxes.show(\n                            \"warning\",\n                            \"No Java Action Selected\",\n                            \"Please open a Java Action document first.\"\n                        );\n                    }\n                }\n            }\n        );\n    }\n};\n\nasync function openJavaEditorTab(javaActionName: string, moduleName: string): Promise<void> {\n    // Java action source files are located at javasource/<ModuleName>/actions/<ActionName>.java\n    const javaFilePath = `javasource/${moduleName}/actions/${javaActionName}.java`;\n    \n    await studioPro.ui.tabs.open(\n        {\n            title: `${javaActionName}.java`,\n            icon: \"\u2615\"\n        },\n        {\n            componentName: \"extension/JavaEditor\",\n            uiEntrypoint: \"tab\",\n            queryParams: {\n                filePath: javaFilePath,\n                actionName: javaActionName,\n                moduleName: moduleName\n            }\n        }\n    );\n}\n\n"],
  "mappings": "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",
  "names": []
}
